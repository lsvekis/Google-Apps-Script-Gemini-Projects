<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <style>
      body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; padding: 16px; }
      input { width: 100%; padding: 8px; margin-bottom: 8px; }
      button { background: #1a73e8; color: #fff; border: 0; padding: 8px 12px; border-radius: 6px; cursor: pointer; }
      pre { background: #f1f3f4; padding: 10px; border-radius: 6px; white-space: pre-wrap; }
      .small { color:#555; font-size:12px; }
      code { background:#eef; padding:2px 4px; border-radius:4px; }
    </style>
  </head>
  <body>
    <h2>🧠 Web Summarizer</h2>
    <input id="url" placeholder="https://example.com/article" />
    <button id="run" onclick="run()">Summarize</button>

    <h3>Result (JSON)</h3>
    <pre id="out">Waiting…</pre>
    <p class="small">Tip: Put URLs in column A and use the menu: <b>Summarize URL Selection → next columns</b>,
      or try the custom function <code>=AI_URL_SUMMARY(A2)</code>.</p>

    <script>
      function run(){
        const btn = document.getElementById('run');
        const url = document.getElementById('url').value || '';
        document.getElementById('out').textContent = '⏳ Fetching & summarizing…';
        btn.disabled = true;

        google.script.run
          .withSuccessHandler(r => {
            document.getElementById('out').textContent = JSON.stringify(r, null, 2);
            btn.disabled = false;
          })
          .withFailureHandler(e => {
            document.getElementById('out').textContent = 'Error: ' + e.message;
            btn.disabled = false;
          })
          .summarizeUrl(url);
      }
    </script>
  </body>
</html>
